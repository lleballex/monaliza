{% extends 'wrapper.html' %}
{% load it_articles_tags %}

{% block top_title %}

	IT articles

{% endblock %}

{% block staticfiles %}

	<script>
		function like(id) {
			$.ajax({
				type: 'get',
				url: "{% url 'it_articles:like_article' %}",
				data: {
					'id': id,
				},	
				dataType: 'text',
				success: function(data) {
					$('#like-' + id).toggleClass('is_liked')
					if(data == 'EXIST') {
						$('#like-' + id + ' .fa').attr('class', 'fa fa-thumbs-o-up');
						$('#like-' + id + ' span').text(Number($('#like-' + id + ' span').text()) - 1);
					} else if(data = 'DOES_NOT_EXIST') {
						$('#like-' + id + ' .fa').attr('class', 'fa fa-thumbs-up');
						$('#like-' + id + ' span').text(Number($('#like-' + id + ' span').text()) + 1);
					}
				},
			});
		}
	</script>

{% endblock %}

{% block content %}

	<div class="content-container">
	<div class="articles new">
		<div class="articles-container">
			<ul>
			{% for article in articles %}
				{% if not request.GET.language or article.language == request.GET.language %}
				<li class="article">
					<div class="article-user">
						{% load static %}
						<img src="{% static 'account/images/user_2.png' %}" alt="" class="user-img"><a href="{% url 'account:profile' %}" class="user-a">{{article.user.username}} </a>
						 - {{article.date|date:'d'}} of {{article.date|date:'F'}} at {{article.date|date:'G:m'}}
					</div>
					<div class="article-title">
						<a href="{% url 'it_articles:detail' article.id %}">{{article.title}}</a>
					</div>
					<div class="article-text">
						{% with article.text|safe as text  %}
							{{text|truncatechars:'900'}}
						{% endwith %}
					</div>
					<div class="article-bottom">
						<a href="{% url 'it_articles:detail' article.id %}" class="btn-read-more">Read more</a>
						<ul class="article-info">
							<li class="first-li like-article {% is_liked request.user article %}" id="like-{{article.id}}" onclick="like({{article.id}})">
								<i class="fa {% is_liked_fa request.user article %}"></i><span>{{article.likes}}</span>
							</li>
							<li><i class="fa fa-eye"></i>   {{article.views}}
							</li>
						</ul>
					</div>
				</li>
					<!--<div class="article">
						{% load static %}
						<a href="{% url 'it_articles:detail' article.id %}"><img src="{% static 'mona.png' %}" alt="{{article.title}} - Picture is not found" class="img"></a>
						<div class="prev-description">
						<div class="article-description">
							<div class="article-words">
								<div class="article-title">
									<a href="{% url 'it_articles:detail' article.id %}">{{article.title}}</a>
								</div>
								<div class="article-user">{{article.user}}</div>
							</div>
							<div class="article-numbers">
								<div class="likes" id="like-{{article.id}}" onclick="like({{article.id}})">
									<i class="fa fa-thumbs-up like" aria-hidden="true"></i><span>{{article.likes}}</span>
								</div>
								<i class="fa fa-comments"></i>{{article.comments.all.count}}
								<i class="fa fa-bookmark" aria-hidden="true"></i>
							</div>
						</div>
						</div>
					</div>-->
				{% endif %}
			{% endfor %}
			</ul>
		</div>
	</div>
</div>
	<!--<div class="articles popular">
		<div class="articles-container">
			{% for article in articles_popular %}
				{% if not request.GET.language or article.language == request.GET.language %}
					<div class="article">
						{% load static %}
						<a href="{% url 'it_articles:detail' article.id %}"><img src="{% static 'mona.png' %}" alt="{{article.title}} - Picture is not found" class="img"></a>
						<div class="prev-description">
						<div class="article-description">
							<div class="article-words">
								<div class="article-title">
									<a href="{% url 'it_articles:detail' article.id %}">{{article.title}}</a>
								</div>
								<div class="article-user">{{article.user}}</div>
							</div>
							<div class="article-numbers">
								<div class="likes" id="like-{{article.id}}" onclick="like({{article.id}})">
									<i class="like" class="fa fa-thumbs-up" aria-hidden="true">ss</i><span>{{article.likes}}</span>
								</div>
								<i class="fa fa-bookmark" aria-hidden="true"></i>
							</div>
						</div>
						</div>
					</div>
				{% endif %}
			{% endfor %}
		</div>
	</div>-->

{% endblock %}